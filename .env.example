########################################
# Application
########################################
LOG_LEVEL=INFO
HOST=0.0.0.0
PORT=8000
# Comma-separated list or * for all (use specific origins in production)
ALLOWED_ORIGINS=*

# ColPali API Configuration
# Option A (recommended): set mode and per-mode URLs
COLPALI_MODE=gpu  # cpu | gpu
COLPALI_CPU_URL=http://localhost:7001
COLPALI_GPU_URL=http://localhost:7002

COLPALI_API_TIMEOUT=300

########################################
# Processing
########################################
# BATCH_SIZE: Number of pages processed per batch during indexing
# - CPU mode: Use 1-2 for better progress feedback
# - GPU mode: Use 4-16 for better throughput (default: 12)
# Note: CPU indexing is ~30-50x slower than GPU (~1.5-3 min/page vs ~1-2s/page)
BATCH_SIZE=12

# Pipelined Indexing: Process multiple batches concurrently to overlap embedding and I/O
# Recommended: True for documents with 4+ pages to improve throughput
ENABLE_PIPELINE_INDEXING=True

########################################
# Qdrant
########################################
QDRANT_EMBEDDED=True
QDRANT_URL=http://localhost:6333
QDRANT_COLLECTION_NAME=documents
QDRANT_SEARCH_LIMIT=20
QDRANT_PREFETCH_LIMIT=200
QDRANT_ON_DISK=True
QDRANT_ON_DISK_PAYLOAD=True
# Enable binary quantization for vectors (set to True to enable)
QDRANT_USE_BINARY=False
# Keep quantized codes in RAM for speed while originals stay on disk
QDRANT_BINARY_ALWAYS_RAM=True
# Search-time quantization params (used when QDRANT_USE_BINARY=True)
QDRANT_SEARCH_IGNORE_QUANT=False
QDRANT_SEARCH_RESCORE=True
QDRANT_SEARCH_OVERSAMPLING=2.0
# Disable for faster indexing on small-scale loads (no mean pooling computation)
QDRANT_MEAN_POOLING_ENABLED=False

########################################
# MinIO
########################################
# Toggle to disable MinIO and store images inline with the Qdrant payload
MINIO_ENABLED=False
# Internal SDK endpoint (inside Docker network or local)
MINIO_URL=http://localhost:9000
# Public URL used in stored links (e.g., Qdrant dashboard, browsers).
# If unset, defaults to MINIO_URL.
MINIO_PUBLIC_URL=http://localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET_NAME=documents
MINIO_WORKERS=12
MINIO_RETRIES=3
MINIO_FAIL_FAST=False
# Whether to set public-read bucket policy automatically
MINIO_PUBLIC_READ=True

# Object storage for document images
IMAGE_FORMAT=JPEG
# JPEG quality (1-100, higher = better quality but larger files)
# Recommended: 75-95 for good quality/size balance. Only applies to JPEG format.
IMAGE_QUALITY=75

########################################
# MUVERA (optional, for fast first-stage retrieval)
########################################
# Enable MUVERA single-vector Fixed Dimensional Encoding (FDE) to speed up
# first-stage retrieval. Multivectors are still used for prefetch & reranking.
MUVERA_ENABLED=False
# Typical parameters as suggested in the Qdrant article example
MUVERA_K_SIM=6
MUVERA_DIM_PROJ=32
MUVERA_R_REPS=20
MUVERA_RANDOM_SEED=42
