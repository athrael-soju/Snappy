########################################
# LOCAL DEVELOPMENT CONFIGURATION
########################################
# NOTE: This file is for LOCAL development only (running services outside Docker).
# Docker deployments use environment variables defined in docker-compose.yml.
# Copy this file to .env and modify as needed for local development.
########################################

########################################
# Application
########################################
# Logging Configuration
LOG_LEVEL=INFO
# Enable JSON logging for production (parseable by log aggregators like ELK, Loki, CloudWatch)
LOG_JSON=false
# Optional: Log to file with rotation (e.g., logs/snappy.log). Leave empty to disable file logging.
LOG_FILE=

HOST=0.0.0.0
PORT=8000
# Comma-separated list or * for all (use specific origins in production)
ALLOWED_ORIGINS=*

# ColPali API Configuration
# Option A (recommended): set mode and per-mode URLs
COLPALI_URL=http://localhost:7000
COLPALI_API_TIMEOUT=300

# DeepSeek OCR configuration
DEEPSEEK_OCR_ENABLED=True
DEEPSEEK_OCR_URL=http://localhost:8200
DEEPSEEK_OCR_API_TIMEOUT=180
DEEPSEEK_OCR_MAX_WORKERS=4
DEEPSEEK_OCR_POOL_SIZE=20
DEEPSEEK_OCR_MODE=Gundam
DEEPSEEK_OCR_TASK=markdown
DEEPSEEK_OCR_LOCATE_TEXT=
DEEPSEEK_OCR_CUSTOM_PROMPT=
DEEPSEEK_OCR_INCLUDE_GROUNDING=True
DEEPSEEK_OCR_INCLUDE_IMAGES=True

########################################
# Processing
########################################
# BATCH_SIZE: Number of pages processed per batch during indexing
# - CPU mode: Use 1-2 for better progress feedback
# - GPU mode: Use 4-16 for better throughput (default: 12)
# Note: CPU indexing is ~30-50x slower than GPU (~1.5-3 min/page vs ~1-2s/page)
BATCH_SIZE=4

# Pipelined Indexing: Process multiple batches concurrently to overlap embedding and I/O
# Recommended: True for documents with 4+ pages to improve throughput
ENABLE_PIPELINE_INDEXING=True

########################################
# Qdrant
########################################
QDRANT_EMBEDDED=False
QDRANT_URL=http://localhost:6333
QDRANT_COLLECTION_NAME=documents
QDRANT_SEARCH_LIMIT=20
QDRANT_PREFETCH_LIMIT=200
QDRANT_ON_DISK=True
QDRANT_ON_DISK_PAYLOAD=True
# Enable binary quantization for vectors (set to True to enable)
QDRANT_USE_BINARY=False
# Keep quantized codes in RAM for speed while originals stay on disk
QDRANT_BINARY_ALWAYS_RAM=True
# Search-time quantization params (used when QDRANT_USE_BINARY=True)
QDRANT_SEARCH_IGNORE_QUANT=False
QDRANT_SEARCH_RESCORE=True
QDRANT_SEARCH_OVERSAMPLING=2.0
# Disable for faster indexing on small-scale loads (no mean pooling computation)
QDRANT_MEAN_POOLING_ENABLED=False

########################################
# Upload Controls
########################################
# Comma-separated list of allowed file extensions (currently PDF-only supported)
UPLOAD_ALLOWED_FILE_TYPES=pdf
# Maximum file size in MB (clamped between 1 and 200)
UPLOAD_MAX_FILE_SIZE_MB=10
# Maximum number of files per upload request (clamped between 1 and 20)
UPLOAD_MAX_FILES=5
# Chunk size for streaming uploads in bytes (clamped between 64KB and 16MB)
UPLOAD_CHUNK_SIZE_MBYTES=2

########################################
# MinIO (Required - Object Storage)
########################################
# Internal SDK endpoint (inside Docker network or local)
MINIO_URL=http://localhost:9000
# Public URL used in stored links (e.g., Qdrant dashboard, browsers).
# If unset, defaults to MINIO_URL.
MINIO_PUBLIC_URL=http://localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET_NAME=documents
MINIO_WORKERS=12
MINIO_RETRIES=3
MINIO_FAIL_FAST=False
# Whether to set public-read bucket policy automatically
MINIO_PUBLIC_READ=True

# Object storage for document images
IMAGE_FORMAT=JPEG
# JPEG quality (1-100, higher = better quality but larger files)
# Recommended: 75-95 for good quality/size balance. Only applies to JPEG format.
IMAGE_QUALITY=75

########################################
# DuckDB Analytics (Optional)
########################################
DUCKDB_ENABLED=True
DUCKDB_URL=http://localhost:8300
DUCKDB_DATABASE_NAME=documents
DUCKDB_API_TIMEOUT=30
DUCKDB_BATCH_SIZE=10
DUCKDB_RETRY_ATTEMPTS=3
# DUCKDB_MERGE_CROSS_PAGE_REGIONS=True

########################################
# OpenAI Configuration (for Chat Feature)
########################################
# Required for chat functionality - get your API key from https://platform.openai.com/api-keys
OPENAI_API_KEY=your-api-key-here
OPENAI_MODEL=gpt-5-nano
OPENAI_TEMPERATURE=1
